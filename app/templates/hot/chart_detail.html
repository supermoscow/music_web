{% extends "base.html" %}

{% block content %}
<div class="chart-detail">
  <h2>{{ chart_type|upper }}榜</h2>

  <div class="song-list">
    {% for song in all_songs %}
    <div class="song-item {% if loop.index > 10 %}extra-song{% endif %}">
      <span class="rank">{{ song.rank }}</span>
      <div class="song-info">
        <span class="name">{{ song.name }}</span>
        <span class="singer">{{ song.singer }}</span>
      </div>
      <span class="duration">{{ song.time//60 }}:{{ '%02d' % (song.time%60) }}</span>
    </div>
    {% endfor %}
  </div>

  {% if all_songs|length > 10 %}
  <div class="toggle-container">
    <button class="toggle-btn" onclick="toggleSongs()">
      查看完整榜单 ▼
    </button>
  </div>
  {% endif %}
</div>

<style>
.extra-song {
  display: none;
}

.song-list.expanded .extra-song {
  display: flex !important;
}

.toggle-btn {
  padding: 10px 20px;
  background: #4a90e2;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s;
}

.toggle-btn:hover {
  background: #1864ab;
}
</style>

<script>
function toggleSongs() {
  const list = document.querySelector('.song-list');
  const btn = document.querySelector('.toggle-btn');

  list.classList.toggle('expanded');

  if (list.classList.contains('expanded')) {
    btn.innerHTML = '收起榜单 ▲';
    // 滚动到按钮位置（可选）
    btn.scrollIntoView({ behavior: 'smooth', block: 'center' });
  } else {
    btn.innerHTML = '查看完整榜单 ▼';
  }
}
</script>
{% endblock %}