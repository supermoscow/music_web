{% extends 'base.html' %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/tools.css') }}">
{% endblock %}

{% block content %}
<h1>灵感记录</h1>
<div>
    <h2>录制音频</h2>
    <button id="startRecording">开始录音</button>
    <button id="stopRecording" disabled>停止录音</button>
    <ul id="recordingsList"></ul>
</div>

<div>
    <h2>伴奏播放</h2>
    <div class="track">
        <span>流行伴奏</span>
        <button id="playPop" class="icon-button">▶️</button>
        <button id="pausePop" class="icon-button">⏸️</button>
        <progress id="playPopProgress" value="0" max="100" class="draggable-progress"></progress>
        <span id="playPopTime">0:00 / 0:00</span>
    </div>
    <div class="track">
        <span>摇滚伴奏</span>
        <button id="playRock" class="icon-button">▶️</button>
        <button id="pauseRock" class="icon-button">⏸️</button>
        <progress id="playRockProgress" value="0" max="100" class="draggable-progress"></progress>
        <span id="playRockTime">0:00 / 0:00</span>
    </div>
    <div class="track">
        <span>爵士伴奏</span>
        <button id="playJazz" class="icon-button">▶️</button>
        <button id="pauseJazz" class="icon-button">⏸️</button>
        <progress id="playJazzProgress" value="0" max="100" class="draggable-progress"></progress>
        <span id="playJazzTime">0:00 / 0:00</span>
    </div>
</div>

<div>
    <h2>测音准</h2>
    <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 10px;">
        <button id="pitch-detect-btn">开始测音准</button>
        <div id="pitch-gauge" style="width:220px;height:80px;position:relative;background:#f8f8f8;border:1px solid #ccc;border-radius:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;">
            <div id="pitch-text" style="font-size:1.2em;">音高: --</div>
            <div id="pitch-offset" style="font-size:1em;">偏移: --</div>
            <div style="width:160px;height:16px;background:#eee;border-radius:8px;margin-top:8px;overflow:hidden;">
                <div id="pitch-bar" style="height:100%;width:50%;background:#4caf50;transition:width 0.1s;"></div>
            </div>
        </div>
    </div>
</div>

<div>
    <h2>虚拟钢琴</h2>
    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
        <label for="reverb-type">混响类型：</label>
        <select id="reverb-type">
            <option value="none">无</option>
            <option value="hall">大厅</option>
            <option value="room">房间</option>
            <option value="plate">板式</option>
        </select>
        <label for="reverb-mix">混响程度：</label>
        <input type="range" id="reverb-mix" min="0" max="1" step="0.01" value="0.5" style="width:100px;">
        <span id="reverb-mix-value">0.50</span>
    </div>
    <div id="piano-container"></div>
</div>

<div>
    <h2>鼓机（电子音序器）</h2>
    <div id="drum-style-selector" style="margin-bottom:10px;"></div>
    <div id="drum-step-selector"></div>
    <div id="drum-machine-controls" style="margin-bottom:10px;">
        <button id="drum-play">▶️ 播放</button>
        <button id="drum-stop">⏸️ 停止</button>
        <label for="drum-bpm">BPM：</label>
        <input type="number" id="drum-bpm" min="60" max="240" value="120" style="width:60px;">
    </div>
    <div id="drum-sequencer"></div>
</div>

<script src="{{ url_for('static', filename='js/inspiration.js') }}"></script>
{% endblock %}
