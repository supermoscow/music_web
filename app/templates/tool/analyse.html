{% extends "tool/tool.html" %}

{% block content %}
<div class="analysis-container">
    <h2>🎵 音频分析</h2>

    <div class="upload-box">
        <input type="file" id="audioFile" accept=".mp3,.wav">
        <div class="drop-zone">
            <i class="upload-icon">↑</i>
            <p>拖放音频文件或点击选择</p>
        </div>
        <div class="progress-bar"></div>
    </div>

    <div class="results">
        <div class="key-result">
            <h3>🎼 调式：<span id="keyResult">-</span></h3>
            <h3>🔄 进行模式：<span id="progressionResult">-</span></h3>
        </div>

        <div class="chord-timeline">
            <div id="timelineChart"></div>
        </div>

        <div class="chord-table">
            <table>
                <thead>
                    <tr><th>时间</th><th>和弦</th><th>置信度</th></tr>
                </thead>
                <tbody id="chordTableBody"></tbody>
            </table>
        </div>
    </div>
</div>

<link href="https://cdn.jsdelivr.net/npm/apexcharts@3.35.0/dist/apexcharts.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/apexcharts@3.35.0"></script>
<script src="{{ url_for('static', filename='js/analysis.js') }}"></script>

<style>
/* 样式表 */
.analysis-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
}

.upload-box {
    border: 2px dashed #ccc;
    padding: 2rem;
    margin: 2rem 0;
    text-align: center;
}

.chord-timeline {
    margin: 2rem 0;
    height: 200px;
}

.chord-table table {
    width: 100%;
    border-collapse: collapse;
}

.chord-table th, .chord-table td {
    padding: 0.8rem;
    border: 1px solid #ddd;
    text-align: center;
}

#timelineChart {
    margin: 1rem 0;
}
</style>
{% endblock %}